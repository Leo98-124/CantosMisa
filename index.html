<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>APP Cantos V1.0</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 5vw;
      background-color: #f4f4f4;
      color: #222;
    }
    h1, h2 {
      color: #2e4a62;
    }
    button.seccion-btn {
      background-color: #2e4a62;
      color: white;
      border: none;
      padding: 10px 15px;
      text-align: left;
      font-size: 1rem;
      width: 100%;
      cursor: pointer;
      margin-top: 10px;
      border-radius: 4px;
    }
    .seccion-btn.activo {
      background-color: #4e6a85;
    }
    .contenedor {
      display: none;
      margin-top: 10px;
      margin-bottom: 25px;
    }
    .canto {
      background-color: #ffffff;
      border-left: 4px solid #2e4a62;
      padding: 15px;
      margin: 15px 0;
      box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.08);
      border-radius: 6px;
      position: relative;
      word-wrap: break-word;
    }
    .titulo {
      font-weight: bold;
      color: #222;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin: 20px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
      .letra {
      white-space: pre-line;
      line-height: 1.2;
    }
    .favorito-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      background-color: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #007acc;
    }
    .favorito-btn:disabled {
      color: #2ecc71;
      cursor: default;
    }
    .mensaje-agregado {
      font-size: 0.85rem;
      color: #2e7d32;
      margin-top: 5px;
      font-weight: 500;
    }
    .detalles {
      display: none;
      margin-top: 10px;
    }
    .canto.expandido .detalles {
      display: block;
    }
    #tema-btn {
      background-color: #2e4a62;
      color: white;
      border: none;
      padding: 8px 16px;
      margin-bottom: 20px;
      cursor: pointer;
      border-radius: 4px;
    }
    #ordinarios .seccion-btn {
      margin-left: 20px;
    }
    #ordinarios .contenedor {
      margin-left: 20px;
      background-color: #f9f9fc;
      border-left: 3px solid #ccd6e0;
      padding: 10px;
      border-radius: 4px;
    }

    /* üåí Tema oscuro */
    body.tema-oscuro {
      background-color: #12181b;
      color: #e0e6ed;
    }
    body.tema-oscuro .canto {
      background-color: #1f2a30;
      border-left-color: #4f9ec4;
    }
    body.tema-oscuro .titulo {
      color: #ffce54;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }
    body.tema-oscuro .letra {
      color: #cdd6df;
    }
    body.tema-oscuro .favorito-btn {
      color: #4fc3f7;
    }
    body.tema-oscuro .favorito-btn:disabled {
      color: #81c784;
    }
    body.tema-oscuro .seccion-btn {
      background-color: #2c3e50;
      color: #ecf0f1;
    }
    body.tema-oscuro .seccion-btn.activo {
      background-color: #3f5870;
    }
    body.tema-oscuro h1,
    body.tema-oscuro h2 {
      color: #ffd369;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }
    body.tema-oscuro #ordinarios .contenedor {
      background-color: #1a232a;
      border-left-color: #4f9ec4;
    }

    /* üì± Responsive */
    @media (max-width: 600px) {
      h1 {
        font-size: 24px;
      }
      button.seccion-btn {
        font-size: 16px;
        padding: 8px 12px;
      }
      .canto {
        padding: 10px;
      }
    }
  </style>
</head>

<body>
  <h1>CANTOS PARROQUIA DE GUADALUPE V1.0</h1>

  <!-- Bot√≥n de cambio de tema -->
  <button onclick="alternarTema()" id="tema-btn">üåô Modo Oscuro</button>

  <!-- Buscador -->
  <input
    type="text"
    id="buscador"
    placeholder="Buscar por nombre, tipo o tema..."
    aria-label="Buscar cantos por nombre, tipo o tema"
    onkeyup="filtrarCantos()"
  />

  <!-- Secci√≥n: Esquema -->
  <button class="seccion-btn" onclick="mostrarOcultar('esquema', this)">üóÇÔ∏è Esquema de la Misa</button>
  <div id="esquema" class="contenedor"></div>

  <!-- Secci√≥n: Entrada -->
  <button class="seccion-btn" onclick="mostrarOcultar('entrada', this)">Cantos de Entrada</button>
  <div id="entrada" class="contenedor"></div>

  <!-- Secci√≥n: Ofertorio -->
  <button class="seccion-btn" onclick="mostrarOcultar('ofertorio', this)">Cantos de Ofertorio</button>
  <div id="ofertorio" class="contenedor"></div>

  <!-- Secci√≥n: Comuni√≥n -->
  <button class="seccion-btn" onclick="mostrarOcultar('comunion', this)">Cantos de Comuni√≥n</button>
  <div id="comunion" class="contenedor"></div>

  <!-- Secci√≥n: Salida -->
  <button class="seccion-btn" onclick="mostrarOcultar('salida', this)">Cantos de Salida</button>
  <div id="salida" class="contenedor"></div>

  <!-- Secci√≥n: Cantos Ordinarios -->
  <button class="seccion-btn" onclick="mostrarOcultar('ordinarios', this)">Cantos Ordinarios</button>
  <div id="ordinarios" class="contenedor">

    <!-- Gloria -->
    <button class="seccion-btn" onclick="mostrarOcultar('gloria', this)">Gloria</button>
    <div id="gloria" class="contenedor"></div>

    <!-- Santo -->
    <button class="seccion-btn" onclick="mostrarOcultar('santo', this)">Santo</button>
    <div id="santo" class="contenedor"></div>

    <!-- Cordero -->
    <button class="seccion-btn" onclick="mostrarOcultar('cordero', this)">Cordero</button>
    <div id="cordero" class="contenedor"></div>
  </div>



  <!-- Script con cantos embebidos -->
  <script>
    const cantos = [
      {
        "titulo": "Caminare En Presencia Del Se√±or",
        "tema": "entrada",
        "letra": 
 `Caminar√© en presencia del Se√±or,
Caminar√© en presencia del Se√±or

Amo al Se√±or porque escucha mi voz suplicante,
Porque inclina su o√≠do hacia m√≠,
El d√≠a que lo invoco...

Caminar√© en presencia del Se√±or,
Caminar√© en presencia del Se√±or...

Me envolv√≠a en redes de muerte,
Ca√≠ en tristeza y en angustia,
Invoqu√© el Nombre del Se√±or:
¬°Se√±or, salva mi vida!...

Caminar√© en presencia del Se√±or,
Caminar√© en presencia del Se√±or...

El Se√±or es benigno y justo
Nuestro Dios es compasivo
El Se√±or guarda a los sencillos
Estando yo sin fuerzas me salv√≥...

Caminar√© en presencia del Se√±or,
Caminar√© en presencia del Se√±or...

Alma m√≠a, recobra tu calma
Que el Se√±or fue bueno contigo
Arranc√≥ mi alma de la muerte,
Mis ojos de las l√°grimas, mis pies de la ca√≠da...

Caminar√© en presencia del Se√±or,
Caminar√© en presencia del Se√±or `
      },
      {
        "titulo": "Dios nos convoca",
        "tema": "entrada",
        "letra": 
 `Dios nos convoca
 Venid y escuchemos su voz
 La mesa ha preparado
 Su pan es salvaci√≥n
 Gracias Se√±or
 Por ser tus invitados. x2
 
 Venid celebrad la palabra
 Venid acoged la verdad
 Y en hermandad
 Cantad la nueva alianza
 
 Dios nos convoca
 Venid y escuchemos su voz
 La mesa ha preparado
 Su pan es salvaci√≥n
 Gracias Se√±or
 Por ser tus invitados.
 
 Venid celebrad la esperanza
 Venid a la cena pascual
 Y en hermandad
 Cantad la nueva alianza
 
 Dios nos convoca
 Venid y escuchemos su voz
 La mesa ha preparado
 Su pan es salvaci√≥n
 Gracias Se√±or
 Por ser tus invitados.`
      },
      {
        "titulo": "Venimos Hoy A Tu Altar",
        "tema": "entrada",
        "letra": 
 `Venimos hoy a tu altar A cantarte Se√±or
Pues tu eres la alegr√≠a De nuestro coraz√≥n
Pues tu eres la alegr√≠a De nuestro coraz√≥n. X2

Tu hiciste los cielos, Los llenas de estrellas, de luz y calor
Tu pintaste la aurora, Hiciste las nubes, las puestas de sol

Venimos hoy a tu altar A cantarte Se√±or
Pues tu eres la alegr√≠a De nuestro coraz√≥n
Pues tu eres la alegr√≠a De nuestro coraz√≥n

Tu creaste la risa, La paz y la dicha, la felicidad
Tu al darnos la vida Nos das tus riquezas tu eterna amistad

Venimos hoy a tu altar A cantarte Se√±or
Pues tu eres la alegr√≠a De nuestro coraz√≥n
Pues tu eres la alegr√≠a De nuestro coraz√≥n

Tu nos diste a tu Madre, Nos diste tu cuerpo, tu sangre es manjar
Tu nos diste esperanza, La fe y nos hiciste capaces de amar

Venimos hoy a tu altar A cantarte Se√±or
Pues tu eres la alegr√≠a De nuestro coraz√≥n
Pues tu eres la alegr√≠a De nuestro coraz√≥n.`
      },
      
      {
        "titulo": "Vino y Pan",
        "tema": "ofertorio",
        "letra": 
`Vino y pan en oblaci√≥n
Esperan el milagro del Se√±or.

Ve nuestra ofrenda sobre tu santo altar
Era en los campos dulce vid y trigal.

Pero t√∫, por tu bondad
Transformas nuestra ofrenda en ti, Se√±or.

Toma mi vida y tambi√©n cambiar√°.
Llena mi alma de tu gracia y tu paz.

Am√©n.`
      },
      {
        "titulo": "Este Pan y Vino Se√±or",
        "tema": "ofertorio",
        "letra": 
`Este pan y vino Se√±or
Se transformaran
En tu cuerpo y sangre se√±or
en nuestro manjar. X2

Gracias al sol y al labrador
En el altar florecen hoy
Las espigas, los racimos,
Que presentamos a Dios

Este pan y vino Se√±or
Se transformaran
En tu cuerpo y sangre se√±or
en nuestro manjar.

Lo que sembr√© con mi dolor,
Lo que ped√≠ en mi oraci√≥n,
Hoy son frutos, son ofrendas,
Que presentamos a Dios.

Este pan y vino Se√±or
Se transformaran
En tu cuerpo y sangre se√±or
en nuestro manjar.`
      },
      {
        "titulo": "Para Ti",
        "tema": "ofertorio",
        "letra": 
`Para Ti es mi m√∫sica, Se√±or
Mi oraci√≥n es m√∫sica, Se√±or
Para Ti, mi oraci√≥n
Para Ti es mi m√∫sica, Se√±or

El Trabajo se√±or te entregamos
Es Pan de vida, amor grande haciaTi

Para Ti es mi m√∫sica, Se√±or
Mi oraci√≥n es m√∫sica, Se√±or
Para Ti, mi oraci√≥n
Para Ti es mi m√∫sica, Se√±or

Con el vino recibe mi gozo
Que en tu sangre preciosa se transformar√°

Para Ti es mi m√∫sica, Se√±or
Mi oraci√≥n es m√∫sica, Se√±or
Para Ti, mi oraci√≥n
Para Ti es mi m√∫sica, Se√±or

Santifica Se√±or nuestros dones
Transf√≥rmanos por ellos, en oblacion a ti
Para Ti es mi m√∫sica, Se√±or
Mi oraci√≥n es m√∫sica, Se√±or
Para Ti, mi oraci√≥n
Para Ti es mi m√∫sica, Se√±or`
      },
      {
        "titulo": "Esto que te doy",
        "tema": "ofertorio",
        "letra": 
`Esto que te doy es vino y pan Se√±or
Esto que te doy es mi trabajo
Es mi coraz√≥n, mi alma
Es mi cuerpo y mi raz√≥n
El esfuerzo de mi caminar

Toma mi vida, ponla en tu coraz√≥n,
Dame tu mano y ll√©vame
Cambia mi pan en tu carne y mi vino en tu sangre
Y a mi, Se√±or, renu√©vame, 
L√≠mpiame Y s√°lvame

Esto que te doy mi vida es Se√±or
Es mi amor tambi√©n es mi dolor
Es la ilusi√≥n, mis sue√±os
Es mi gozo y mi llorar
Es mi canto y mi oraci√≥n

Toma mi vida, ponla en tu coraz√≥n,
Dame tu mano y ll√©vame
Cambia mi pan en tu carne y mi vino en tu sangre
Y a mi, Se√±or, renu√©vame, 
L√≠mpiame Y s√°lvame

Esto que te doy, no s√≥lo yo, Se√±or
Esta voz tambi√©n es de mi hermano
Es la uni√≥n, la paz, el orden,
La armon√≠a y felicidad,
Es un canto en comunidad

Toma mi vida, ponla en tu coraz√≥n,
Dame tu mano y ll√©vame
Cambia mi pan en tu carne y mi vino en tu sangre
Y a mi, Se√±or, renu√©vame, 
L√≠mpiame Y s√°lvame`
      },
      
      {
        "titulo": "Symbolum 77",
        "tema": "comunion",
        "letra": 
`Eres T√∫ mi vida, solo T√∫, Se√±or
Eres mi Camino, eres mi Verdad
Seguir√© tus pasos, me guiar√° tu amor
T√∫ me has dado vida nueva y tu salvaci√≥n
Ya no tengo m√°s temor si t√∫ est√°s aqu√≠
Te lo ruego, qu√©date en m√≠.

Creo en Jesucristo, hijo de Mar√≠a
Hijo eterno y Santo, nuestro Redentor
Creo que por salvarme moriste en la cruz
Y al resucitar me diste vida en plenitud
En el pan y el vino te nos das, Se√±or
Llena mi alma, dame tu amor

Eres t√∫ mi fuerza, solo t√∫, Se√±or
Eres mi camino y mi libertad
Nada en este mundo nos separar√°
Yo s√© que tu mano fuerte no me dejar√°
De todos los males t√∫ me librar√°s
Te lo pido, dame tu paz

Eres pan de vida, fuente de amor
T√∫ mi fortaleza, ¬°eres mi Se√±or!
T√∫ que sabes bien quien soy dame tu perd√≥n
En tus manos yo me entrego todo entero a ti
Qu√©date en mi coraz√≥n, llena mi existir
Te lo ruego, qu√©date en m√≠

Eres T√∫ mi vida, solo T√∫, Se√±or
Eres mi Camino, eres mi Verdad
Seguir√© tus pasos, me guiar√° tu amor
T√∫ me has dado vida nueva y tu salvaci√≥n
Ya no tengo m√°s temor si t√∫ est√°s aqu√≠
Te lo ruego, qu√©date en m√≠.`
      },
      {
        "titulo": "Las Manos Abiertas",
        "tema": "comunion",
        "letra": 
`Las Manos abiertas ante Ti, Se√±or,
Para ofrecerte al mundo
Las manos abiertas ante Ti, Se√±or,
Nuestro gozo es profundo. X2

Gu√°rdanos peque√±os ante Ti, Se√±or,
Simples y puros como un manantial
Guardanos peque√±os antes nuestros hermanos
Y disponibles como el agua.

Las Manos abiertas ante Ti, Se√±or,
Para ofrecerte al mundo
Las manos abiertas ante Ti, Se√±or,
Nuestro gozo es profundo.

Gu√°rdanos peque√±os ante Ti, Se√±or
Llenos de amor, llenos de gozo
Gu√°rdanos peque√±os ante nuestros hermanos,
Simples caminos que nos lleven a Ti.

Las Manos abiertas ante Ti, Se√±or,
Para ofrecerte al mundo
Las manos abiertas ante Ti, Se√±or,
Nuestro gozo es profundo.`
      },
      
      {
        "titulo": "Alma Misionera",
        "tema": "salida",
        "letra": 
`Se√±or,
Toma mi vida nueva
Antes de que la espera
Desgaste a√±os en m√≠

Estoy,
Dispuesto a lo que quieras
No importa lo que sea
T√∫ ll√°mame a servir

Ll√©vame donde los hombres
Necesiten Tus palabras
Necesiten Tus ganas de vivir
Donde falte la esperanza
Donde falte la alegr√≠a
Simplemente
Por no saber de ti

Te doy,
Mi coraz√≥n sincero
Para gritar sin miedo
Lo hermoso que es Tu amor

Tendr√©,
Mis brazos sin cansancio
Tu historia entre mis labios
Y fuerza en la oraci√≥n

Ll√©vame donde los hombres
Necesiten Tus palabras
Necesiten Tus ganas de vivir
Donde falte la esperanza
Donde falte la alegr√≠a
Simplemente
Por no saber de ti

Y as√≠,
En marcha ir√© cantando
Por pueblos predicando
Tu grandeza, Se√±or

Se√±or,
Tengo alma misionera
Cond√∫ceme a la tierra
Que tenga sed de Dios

Ll√©vame donde los hombres
Necesiten Tus palabras
Necesiten Tus ganas de vivir
Donde falte la esperanza
Donde falte la alegr√≠a
Simplemente
Por no saber de ti

Ll√©vame donde los hombres
Necesiten Tus palabras
Necesiten Tus ganas de vivir
Donde falte la esperanza
Donde falte la alegr√≠a
Simplemente
Por no saber de ti

Simplemente
Por no saber de ti`
      },
      
      {
        "titulo": "Gloria - Misa Ritmica",
        "tema": "gloria",
        "letra": 
`Gloria, gloria, a Dios en el cielo y en la tierra a los hombres paz. x2

Te alabamos y te bendecimos, te adoramos y glorificamos,
y nosotros hoy te damos gracias
por tu grande y eterna gloria.

Gloria, gloria a Dios en el cielo y en la tierra a los hombres paz.

Se√±or Dios, nuestro 
Padre, Padre, Padre.
Se√±or Dios, Hijo
Piedad, piedad, piedad Se√±or.
T√∫ que quitas el pecado del mundo,
Esc√∫chanos, esc√∫chanos
T√∫ que est√°s a la derecha del Padre,
Piedad, piedad, piedad Se√±or.

Solo T√∫ eres Santo, solo T√∫ Se√±or,
Solo T√∫ Alt√≠simo, Jesucristo
Con el Santo Esp√≠ritu en la gloria de Dios Padre.
Am√©n, am√©n, am√©n.
Am√©n, am√©n, am√©n.`
      },
      {
        "titulo": "Gloria",
        "tema": "gloria",
        "letra": 
`Gloria al se√±or, que reina en el cielo
Y en la tierra paz, a los hombres que ama √©l. x2

Se√±or te alabamos 
Se√±or te bendecimos
Todos te adoramos
Gracias por tu gloria.

Gloria al se√±or, que reina en el cielo
Y en la tierra paz, a los hombres que ama √©l.

Tu eres el cordero, que quita el pecado
Ten piedad de nosotros
Y escucha nuestra oracion.

Gloria al se√±or, que reina en el cielo
Y en la tierra paz, a los hombres que ama √©l.

Tu solo eres santo
Tu solo el altisimo
Con el espiritu santo
En la gloria de dios padre.

Gloria al se√±or, que reina en el cielo
Y en la tierra paz, a los hombres que ama √©l.`
      },
      
      {
        "titulo": "Santo, Santo, Santo",
        "tema": "santo",
        "letra": 
`Santo, Santo, Santo 
Es el Se√±or Dios del universo
Llenos est√°n el cielo 
Y la tierra de tu gloria

Hosanna, Hosanna, Hosanna en el cielo
Hosanna, Hosanna, Hosanna en el cielo

Bendito el que viene en el nombre del Se√±or

Hosanna, Hosanna, Hosanna en el cielo
Hosanna, Hosanna, Hosanna en el cielo`
      },
      
      {
        "titulo": "Cordero de Dios",
        "tema": "cordero",
        "letra": 
`Cordero de Dios que quitas
El pecado del mundo
Ten piedad de nosotros
Ten piedad de nosotros

Cordero de Dios que quitas
El pecado del mundo
Ten piedad de nosotros
Ten piedad de nosotros

Cordero de Dios que quitas
El pecado del mundo
Danos la paz, Danos la paz
Danos, danos, danos la paz
Danos, danos, danos la paz.`
      }
    ];
  
  function cargarCantosDesdeVariable() {
    const agrupados = {};
    cantos.forEach(canto => {
      const temaId = canto.tema.toLowerCase().replace(/\s/g, "");
      if (!agrupados[temaId]) agrupados[temaId] = [];
      agrupados[temaId].push(canto);
    });

    Object.entries(agrupados).forEach(([temaId, lista]) => {
      const contenedor = document.getElementById(temaId);
      if (!contenedor) {
        console.warn(`No hay un contenedor con id="${temaId}"`);
        return;
      }

      lista.sort((a, b) => a.titulo.localeCompare(b.titulo, 'es', { sensitivity: 'base' }));

      lista.forEach(canto => {
        const div = document.createElement('div');
        div.className = 'canto';
        div.setAttribute('data-titulo', canto.titulo);
        div.setAttribute('data-tema', canto.tema);
        div.onclick = () => div.classList.toggle('expandido');

        div.innerHTML = `
          <button class="favorito-btn" onclick="agregarAlEsquema(event, this)">+</button>
          <div class="titulo">${canto.titulo}</div>
          <div class="detalles">
            <div>Tema: ${canto.tema}</div>
            <div class="letra"><strong>Letra:</strong><br>${canto.letra}</div>
          </div>
        `;

        contenedor.appendChild(div);
      });
    });

    restaurarEstadoFavoritos();
  }

  function mostrarOcultar(id, boton) {
    const contenedor = document.getElementById(id);
    const visible = contenedor.style.display === "block";
    contenedor.style.display = visible ? "none" : "block";
    boton.classList.toggle("activo", !visible);
  }

  function filtrarCantos() {
    const entrada = document.getElementById("buscador").value.toLowerCase();
    const secciones = document.querySelectorAll(".contenedor");

    secciones.forEach(seccion => {
      const cantos = seccion.querySelectorAll(".canto");
      let coincidencia = false;

      cantos.forEach(canto => {
        const texto = canto.innerText.toLowerCase();
        if (texto.includes(entrada)) {
          canto.style.display = "";
          coincidencia = true;
        } else {
          canto.style.display = "none";
        }
      });

      seccion.style.display = coincidencia ? "block" : "none";
      const btn = document.querySelector(`button[onclick*="${seccion.id}"]`);
      if (btn) {
        btn.style.display = coincidencia || entrada === "" ? "block" : "none";
        btn.classList.toggle("activo", coincidencia);
      }
    });
  }

  function alternarTema() {
    const body = document.body;
    const btn = document.getElementById("tema-btn");
    body.classList.toggle("tema-oscuro");
    const oscuro = body.classList.contains("tema-oscuro");
    btn.textContent = oscuro ? "‚òÄÔ∏è Modo Claro" : "üåô Modo Oscuro";
    localStorage.setItem("temaOscuro", oscuro);
  }

  document.addEventListener("DOMContentLoaded", () => {
    if (localStorage.getItem("temaOscuro") === "true") {
      document.body.classList.add("tema-oscuro");
      const btn = document.getElementById("tema-btn");
      if (btn) btn.textContent = "‚òÄÔ∏è Modo Claro";
    }

    cargarCantosDesdeVariable();
    mostrarEsquema();
    mostrarSeccionEsquemaSiExiste();
  });

  function agregarAlEsquema(event, boton) {
    event.stopPropagation();
    const canto = boton.closest('.canto');
    const titulo = canto.getAttribute('data-titulo');
    const tema = canto.getAttribute('data-tema');
    const letra = canto.querySelector('.letra')?.textContent.trim() || "";

    const nuevo = { titulo, tema, letra };
    let esquema = JSON.parse(localStorage.getItem('esquema')) || [];

    const yaExiste = esquema.some(c => c.titulo === titulo && c.tema === tema);
    if (!yaExiste) {
      esquema.push(nuevo);
      localStorage.setItem('esquema', JSON.stringify(esquema));
      mostrarEsquema();

      boton.disabled = true;
      boton.textContent = "‚úîÔ∏è";

      const mensaje = document.createElement('div');
      mensaje.textContent = '‚úÖ Agregado al esquema';
      mensaje.className = 'mensaje-agregado';
      boton.parentElement.appendChild(mensaje);

      setTimeout(() => mensaje.remove(), 3000);
      mostrarSeccionEsquemaSiExiste();
    } else {
      boton.disabled = true;
      boton.textContent = "‚úîÔ∏è";
    }
  }

  function mostrarEsquema() {
    const contenedor = document.getElementById('esquema');
    contenedor.innerHTML = '';
    const esquema = JSON.parse(localStorage.getItem('esquema')) || [];

    esquema.forEach((canto, index) => {
      const div = document.createElement('div');
      div.classList.add('canto');
      div.innerHTML = `
        <button class="favorito-btn" onclick="eliminarDelEsquema(${index})">üóëÔ∏è</button>
        <div class="titulo">${canto.titulo}</div>
        <div class="detalles">
          <div>Tema: ${canto.tema}</div>
          <div class="letra">${canto.letra}</div>
        </div>
      `;
      div.onclick = () => div.classList.toggle('expandido');
      contenedor.appendChild(div);
    });
  }

  function eliminarDelEsquema(indice) {
    let esquema = JSON.parse(localStorage.getItem('esquema')) || [];
    const eliminado = esquema[indice];
    esquema.splice(indice, 1);
    localStorage.setItem('esquema', JSON.stringify(esquema));
    mostrarEsquema();

    const todos = document.querySelectorAll('.canto');
    todos.forEach(canto => {
      const titulo = canto.getAttribute('data-titulo');
      const tema = canto.getAttribute('data-tema');
      if (titulo === eliminado.titulo && tema === eliminado.tema) {
        const boton = canto.querySelector('.favorito-btn');
        if (boton) {
          boton.disabled = false;
          boton.textContent = "+";
        }
      }
    });
  }

  function restaurarEstadoFavoritos() {
    const esquema = JSON.parse(localStorage.getItem('esquema')) || [];
    const cantos = document.querySelectorAll('.canto');
    cantos.forEach(canto => {
      const titulo = canto.getAttribute('data-titulo');
      const tema = canto.getAttribute('data-tema');
      const boton = canto.querySelector('.favorito-btn');
      if (boton && esquema.some(c => c.titulo === titulo && c.tema === tema)) {
        boton.disabled = true;
        boton.textContent = "‚úîÔ∏è";
      }
    });
  }

  function mostrarSeccionEsquemaSiExiste() {
    const esquema = JSON.parse(localStorage.getItem('esquema')) || [];
    if (esquema.length > 0) {
      const contenedor = document.getElementById('esquema');
      const boton = document.querySelector('button[onclick*="esquema"]');
      if (contenedor && boton) {
        contenedor.style.display = "block";
        boton.classList.add("activo");
      }
    }
  }
</script>
</body>
</html>

